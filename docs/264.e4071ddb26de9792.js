"use strict";(self.webpackChunkDashboard=self.webpackChunkDashboard||[]).push([[264],{264:(_,g,o)=>{o.r(g),o.d(g,{PersonsModule:()=>w});var v=o(6814),b=o(4104),f=o(617),l=o(7700),P=o(279),y=o(4190),t=o(5879),T=o(5619),h=o(7394),c=o(6223),C=o(4004),d=o(4052),D=o(8209),Z=o(9862);let p=(()=>{class s{constructor(e,i){this.http=e,this.dialog=i,this.dataList=[],this.dataListSubject=new T.X([]),this.data$=this.dataListSubject.asObservable(),this.formFields=[{type:d.f.Text,label:"Name",name:"name",validations:[c.kI.required]},{type:d.f.Text,label:"Surname",name:"surname",validations:[c.kI.required]},{type:d.f.Select,label:"Sex",name:"sex",options:["Male","Female"],validations:[c.kI.required]},{type:d.f.Date,label:"Date Of Birth",name:"dateOfBirth",validations:[c.kI.required]},{type:d.f.Date,label:"Name Day",name:"nameDay"},{type:d.f.Number,label:"PESEL",name:"socialSecurityNumber",validations:[c.kI.required]},{type:d.f.Text,label:"ID card",name:"IDcard"}],this.url="https://dashboard-e83c7-default-rtdb.firebaseio.com/persons/personsList.json",this.subscription=new h.w0}getList(){this.subscription.add(this.http.get(this.url).subscribe({next:e=>{const i=null!==e?e:[];this.dataList=i,this.dataListSubject.next(i)},error:()=>{this.dialog.open(D.W,{data:{title:"Error",description:"Error while fetching data",type:"error"}})}}))}addUniqueId(){return(0,C.Z)()}add(e){const i=[...this.dataList,e];this.dataListSubject.next(i),this.subscription.add(this.http.put(this.url,i).subscribe(()=>{this.dataList=i}))}update(e){const i=[...this.dataList],n=i.findIndex(r=>r.id===e.id);-1!==n&&(i[n]=e,this.dataListSubject.next(i),this.subscription.add(this.http.put(this.url,i).subscribe(()=>{this.dataList=i})))}delete(e){const i=[...this.dataList],n=i.findIndex(r=>r.id===e.id);-1!==n&&(i.splice(n,1),this.dataListSubject.next(i),this.subscription.add(this.http.put(this.url,i).subscribe(()=>{this.dataList=i})))}getFormFields(){return this.formFields.slice()}ngOnDestroy(){this.subscription.unsubscribe()}}return s.\u0275fac=function(e){return new(e||s)(t.LFG(Z.eN),t.LFG(l.uw))},s.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var m=o(5819);let A=(()=>{class s{constructor(e,i,n,r){this.dialogRef=e,this.dialogData=i,this.dataService=n,this.timeAlertService=r}ngOnInit(){this.title=this.dialogData.title,this.person=this.dialogData.person,this.alertService=this.dialogData.alertService}updateHandler(e){e.id=this.person.id;const i=this.timeAlertService.getDaysToAnniversary(e.dateOfBirth);if(this.updateTimeAlert(i,"Birthday",e),e.nameDay){const n=this.timeAlertService.getDaysToAnniversary(e.nameDay);this.updateTimeAlert(n,"Name Day",e)}this.dataService.update(e)}updateTimeAlert(e,i,n){e<=30?this.alertService.updateAlert(this.title,this.person.id,n.name,n.surname,e,i):this.alertService.deleteAlertByItem(this.title,this.person.id,i)}}return s.\u0275fac=function(e){return new(e||s)(t.Y36(l.so),t.Y36(l.WI),t.Y36(p),t.Y36(m.X))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-update-person-dialog"]],decls:1,vars:2,consts:[[3,"title","data","submitFormEvent"]],template:function(e,i){1&e&&(t.TgZ(0,"app-person-form",0),t.NdJ("submitFormEvent",function(r){return i.updateHandler(r)}),t.qZA()),2&e&&t.Q6J("title",i.title)("data",i.person)}}),s})();var u=o(9758),F=o(6758),E=o(1424);let S=(()=>{class s{constructor(e,i){this.dialogRef=e,this.dataService=i,this.submitFormEvent=new t.vpe}ngOnInit(){this.formFields=this.dataService.getFormFields()}closeHandler(){this.dialogRef.close()}submitHandler(e){this.submitFormEvent.emit(e)}}return s.\u0275fac=function(e){return new(e||s)(t.Y36(l.so),t.Y36(p))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-person-form"]],inputs:{data:"data",title:"title"},outputs:{submitFormEvent:"submitFormEvent"},decls:4,vars:3,consts:[["mat-dialog-title","",1,"title"],["mat-dialog-content",""],[3,"data","fields","submitEvent","closeEvent"]],template:function(e,i){1&e&&(t.TgZ(0,"p",0),t._uU(1),t.qZA(),t.TgZ(2,"div",1)(3,"app-create-form",2),t.NdJ("submitEvent",function(r){return i.submitHandler(r)})("closeEvent",function(){return i.closeHandler()}),t.qZA()()),2&e&&(t.xp6(1),t.Oqu(i.data?"Edit "+i.data.name+" "+i.data.surname:"Add new "+i.title.slice(0,-1)),t.xp6(2),t.Q6J("data",i.data)("fields",i.formFields))},dependencies:[E.I,l.uh,l.xY],styles:[".title[_ngcontent-%COMP%]{color:var(--color-text-light)}"]}),s})(),I=(()=>{class s{constructor(e,i,n,r){this.dialogRef=e,this.dialogData=i,this.dataService=n,this.timeAlertService=r}ngOnInit(){this.title=this.dialogData.title,this.alertService=this.dialogData.alertService}addHandler(e){const i=this.dataService.addUniqueId();e.id=i,this.newItem=e;const n=this.timeAlertService.getDaysToAnniversary(e.dateOfBirth);if(this.checkTimeAlert(n,"Birthday"),e.nameDay){const r=this.timeAlertService.getDaysToAnniversary(e.nameDay);this.checkTimeAlert(r,"Name Day")}this.dataService.add(this.newItem)}checkTimeAlert(e,i){e<=30&&this.alertService.addAlert(this.title,this.newItem.id,this.newItem.name,this.newItem.surname,e,i)}}return s.\u0275fac=function(e){return new(e||s)(t.Y36(l.so),t.Y36(l.WI),t.Y36(p),t.Y36(m.X))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-add-person-dialog"]],decls:1,vars:1,consts:[[3,"title","submitFormEvent"]],template:function(e,i){1&e&&(t.TgZ(0,"app-person-form",0),t.NdJ("submitFormEvent",function(r){return i.addHandler(r)}),t.qZA()),2&e&&t.Q6J("title",i.title)},dependencies:[S]}),s})();var O=o(7706),U=o(9132),x=o(5301);function L(s,a){if(1&s&&(t.TgZ(0,"p")(1,"span"),t._uU(2,"Wedding"),t.qZA(),t._uU(3),t.qZA()),2&s){const e=t.oxw();t.xp6(3),t.hij(": ",e.details.nameDay,"")}}function Y(s,a){if(1&s&&(t.TgZ(0,"p")(1,"span"),t._uU(2,"PESEL"),t.qZA(),t._uU(3),t.qZA()),2&s){const e=t.oxw();t.xp6(3),t.hij(": ",e.details.socialSecurityNumber,"")}}function B(s,a){if(1&s&&t._UZ(0,"app-progress",6),2&s){const e=t.oxw();t.Q6J("days",e.nameDay)}}let N=(()=>{class s{constructor(e,i){this.timeAlertService=e,this.alertService=i,this.subscription=new h.w0}ngOnInit(){this.age=this.timeAlertService.getAge(this.details.dateOfBirth),this.birthdayDate=this.timeAlertService.getDaysToAnniversary(this.details.dateOfBirth),this.details.nameDay&&(this.nameDay=this.timeAlertService.getDaysToAnniversary(this.details.nameDay)),this.subscription.add(this.alerts$.subscribe(e=>{this.alerts=e})),this.alerts?.length>0?this.updateTimeAlert(this.birthdayDate,"Birthday"):this.alerts?.length>0&&this.details.nameDay&&this.updateTimeAlert(this.nameDay,"Name Day")}updateTimeAlert(e,i){const n=this.alertService.isUpdateAlertNeeded(this.details.id,i,e);n&&e<=30?this.alertService.updateAlert(this.title,this.details.id,this.details.name,this.details.surname,e,i):n&&this.alertService.deleteAlertByItem(this.title,this.details.id,i)}getIconAge(){return this.age<1?"child_friendly":this.age>=1&&this.age<18?"child_care":"person"}ngOnDestroy(){this.subscription.unsubscribe()}}return s.\u0275fac=function(e){return new(e||s)(t.Y36(m.X),t.Y36(u.c))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-person-details"]],inputs:{details:"details",alerts$:"alerts$",title:"title"},decls:35,vars:11,consts:[[1,"details"],[4,"ngIf"],[1,"person"],[1,"progress-container"],["title","Birthday",3,"days"],["title","Wedding",3,"days",4,"ngIf"],["title","Wedding",3,"days"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"div")(2,"p")(3,"span"),t._uU(4,"Name"),t.qZA(),t._uU(5),t.qZA(),t.TgZ(6,"p")(7,"span"),t._uU(8,"Surname"),t.qZA(),t._uU(9),t.qZA(),t.TgZ(10,"p")(11,"span"),t._uU(12,"Sex"),t.qZA(),t._uU(13),t.qZA()(),t.TgZ(14,"div")(15,"p")(16,"span"),t._uU(17,"Birthday"),t.qZA(),t._uU(18),t.qZA(),t.YNc(19,L,4,1,"p",1),t.YNc(20,Y,4,1,"p",1),t.TgZ(21,"p")(22,"span"),t._uU(23,"ID card"),t.qZA(),t._uU(24),t.qZA()(),t.TgZ(25,"div",2)(26,"mat-icon"),t._uU(27),t.qZA(),t.TgZ(28,"p")(29,"span"),t._uU(30,"Age"),t.qZA(),t._uU(31),t.qZA()(),t.TgZ(32,"div",3),t._UZ(33,"app-progress",4),t.YNc(34,B,1,1,"app-progress",5),t.qZA()()),2&e&&(t.xp6(5),t.hij(": ",i.details.name,""),t.xp6(4),t.hij(": ",i.details.surname,""),t.xp6(4),t.hij(": ",i.details.sex,""),t.xp6(5),t.hij(": ",i.details.dateOfBirth,""),t.xp6(1),t.Q6J("ngIf",i.details.nameDay),t.xp6(1),t.Q6J("ngIf",i.details.socialSecurityNumber),t.xp6(4),t.hij(": ",i.details.IDcard,""),t.xp6(3),t.Oqu(i.getIconAge()),t.xp6(4),t.hij(": ",i.age,""),t.xp6(2),t.Q6J("days",i.birthdayDate),t.xp6(1),t.Q6J("ngIf",i.details.nameDay))},dependencies:[v.O5,x.t,f.Hw],styles:["[_nghost-%COMP%]{width:100%;margin-top:20px}.details[_ngcontent-%COMP%]{display:flex;color:var(--color-text);min-height:100px}.details[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:700}.details[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(2){margin-left:40px}.person[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column;width:200px;height:110px;margin-left:40px}.person[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{width:80px;height:80px;font-size:80px;color:var(--color-base)}"]}),s})();function $(s,a){if(1&s&&t._UZ(0,"app-person-details",2),2&s){const e=a.element,i=t.oxw();t.Q6J("title",i.title)("details",e)("alerts$",i.alerts$)}}const j=[{path:"",component:(()=>{class s{constructor(e,i,n,r){this.dialog=e,this.menuService=i,this.dataService=n,this.alertService=r,this.headers=["name","surname"],this.subscription=new h.w0}ngOnInit(){this.getSectionInfo(F.Q.Persons),this.alertService.getAlerts(this.title),this.dataService.getList(),this.data$=this.dataService.data$,this.alerts$=this.alertService.categoryAlerts$}getSectionInfo(e){this.sections=this.menuService.getSections(),this.title=this.sections[e].title;const i=this.sections.find(n=>n.title===this.title);i&&(this.icon=i.icon)}addDialog(){this.dialog.open(I,{width:"500px",data:{alertService:this.alertService,title:this.title}})}editDialog(e){this.dialog.open(A,{width:"500px",data:{title:this.title,person:e,alertService:this.alertService}})}deleteDialog(e){const i=this.dialog.open(D.W,{data:{title:`Delete ${e.name}`,description:`Are you sure you want to delete ${e.name} ${e.surname}`,type:"submit"}});this.subscription.add(i.afterClosed().subscribe(n=>{"submit"===n&&(this.alertService.deleteAlert(this.title,e.id),this.dataService.delete(e))}))}ngOnDestroy(){this.subscription.unsubscribe()}}return s.\u0275fac=function(e){return new(e||s)(t.Y36(l.uw),t.Y36(O.h),t.Y36(p),t.Y36(u.c))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-persons"]],features:[t._Bn([u.c])],decls:3,vars:5,consts:[[3,"title","icon","alerts$","data$","columnsToDisplay","addEvent","editEvent","deleteEvent"],["detailsTemplate",""],[3,"title","details","alerts$"]],template:function(e,i){1&e&&(t.TgZ(0,"app-table",0),t.NdJ("addEvent",function(){return i.addDialog()})("editEvent",function(r){return i.editDialog(r)})("deleteEvent",function(r){return i.deleteDialog(r)}),t.YNc(1,$,1,3,"ng-template",null,1,t.W1O),t.qZA()),2&e&&t.Q6J("title",i.title)("icon",i.icon)("alerts$",i.alerts$)("data$",i.data$)("columnsToDisplay",i.headers)},dependencies:[U.a,N]}),s})()}];let M=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[y.Bz.forChild(j),y.Bz]}),s})(),w=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[M,v.ez,P.m,b.Nh,f.Ps,l.Is]}),s})();t.B6R(A,[S],[])}}]);